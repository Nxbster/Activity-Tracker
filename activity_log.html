<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">  
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="author" content="Ben Phillips and Read Schlomer">
  <meta name="description" content="Activity Log screen for the activity tracker webapp">  
  
  <title>Activity Log</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
  <link rel="stylesheet" type="text/css" href="./styles/activitylogstylesheet.css" />

</head>

<script>
  //Set user's focus to the activity selection dropdown upon loading the page
  function focusActivity() {
     	document.activityInput.activity.focus();   	 
     }
</script>



<body onload="focusActivity()">
  
  <!--Header inspired by: view-source:https://getbootstrap.com/docs/4.1/examples/pricing/-->
  <div class="d-flex flex-column flex-md-row align-items-center p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm">
    <h3 class="my-0 mr-md-auto font-weight-bold" style="color:black">Akbar's Activity Log</h3>
    <nav class="my-2 my-md-0 mr-md-3">
      <a class="p-2 text-dark" href="eat_log.html">Eating Log</a>
      <a class="p-2 text-dark" href="activity_log.html">Activity Log</a>
      <a class="p-2 text-dark" href="dashboard.html">Dashboard</a>
    </nav>
    <a class="btn btn-outline-primary" href="#">Log out</a>
  </div>

    <h2 class="page-subheading"> Hello Akbar! &nbsp; What have you done today? </h2></br>

    <form class="form-input" name="activityInput">
      <div class="form-group">
        <label for="activity">Activity:&nbsp;&nbsp; </label>
        <select name="activity" id="activity" required>
            <option disabled selected value> -- select an activity -- </option>
            <option value="swimming">Swimming</option>
            <option value="biking">Biking</option>
            <option value="walking">Walking</option>
        </select>

        <label for="activity-date">&nbsp;&nbsp;Date:&nbsp;&nbsp;</label>
        <input type="date" id="activity-date" name="activity-date" required> 
        
        <label for="activity-time">&nbsp;&nbsp;Time: &nbsp;&nbsp;</label>
        <input type="time" id="activity-time" name="activity-time" required></br>
      </div>

        <div class="input-group input-group-sm mb-3">
          <label for="activity-time-spent">Time Spent: &nbsp;&nbsp;</label>
          <input type="text" id="activity-time-spent" name="activity-time-spent" required><br>
          <div class="input-group-append">
            <span class="input-group-text" id="basic-addon2">minutes</span>
          </div>
        </div>  

        <div class="input-group input-group-sm mb-3">
          <label for="activity-distance">Distance: &nbsp;&nbsp;</label>
          <input type="text" class="distance-input" id="activity-distance" name="activity-distance" required><br>
          <div class="input-group-append">
            <span class="input-group-text" id="basic-addon2" >miles</span>
          </div>
        </div>

        <label for="activity-comments">Comments: </label> </br>
        <textarea name="activity-comments" id="activity-comments" rows="4" cols="50" placeholder="How was your activity?"></textarea>

        <input type="button" value="Submit" class="btn btn-secondary" id="input-button" ></br></br></br>
    </form>

  </br>
    <div>
      <h4 style="display:inline;padding-left: 20px;">&nbsp;&nbsp;Recent Workouts: </h4>  &nbsp;&nbsp;
        <input type="button" class="btn btn-secondary btn-md" value=" Show Table " id="show-button" title="click to show table">  &nbsp;&nbsp; 
        <input type="button" class="btn btn-secondary btn-md" value=" Hide Table" id="hide-button" title="click to hide table">
    </div> </br> 
      <table id="workout-table" class="table table-striped table-hover">
        <thead class="thead-dark">
          <tr>
            <th>Date</th>
            <th>Time</th>
            <th>Activity</th>
            <th>Distance</th>
            <th>Calories Burned</th>
          </tr> 
        </thead>
        <tbody style="color:white">
            <tr>
                <td>2021-02-03</td>
                <td>3:30pm</td>
                <td>Running</td>
                <td>2.3 miles</td>
                <td>500 calories</td>
            </tr>
            <tr>
                <td>2021-02-04</td>
                <td>1:30pm</td>
                <td>Swimming</td>
                <td>1.2 miles</td>
                <td>393 calories</td>
            </tr>
        </tbody>
      </table>  


      <!--Code influenced by: https://getbootstrap.com/docs/4.1/examples/checkout/?-->
      <footer>
        <p>&copy; 2021 Ben Phillips and Read Schlomer</p>
      </footer>

    </div>

        <script>

          //Code to validate types of Time Spent and Distance input fields
          function isInt(str){
            var val = parseInt(str);
            return (val > 0);
          }

          function validateInputTypes(){

            var timeSpent = document.getElementById("activity-time-spent");
            if (!isInt(timeSpent.value)){
              alert("Time Spent must be inputted as an integer");
              //Delete improper input in Time Spent and Distance fields
              document.getElementById("activity-time-spent").value = "";
              document.getElementById("activity-distance").value = "";
              return false;
            } 

            var distance = document.getElementById("activity-distance")
            if (!isInt(distance.value)){
              alert("Distance must be inputted as an integer");
              //Delete improper input in Time Spent and Distance fields
              document.getElementById("activity-time-spent").value = "";
              document.getElementById("activity-distance").value = "";
              return false;
            }               
          }


          //Code to add inputted data to below summary table
          function logActivity() {
            var date = document.getElementById("activity-date");
            console.log(date);
            var time = document.getElementById("activity-time");
            var timeFormat = "";
            if (time.value.charAt(0) == '0'){
              timeFormat = time.value.slice(1);
            }
            else{
              timeFormat = time.value;
            }
            var activity = document.getElementById("activity");
            //Uppercase the activity
            var activityUppercase = activity.value.charAt(0).toUpperCase() + activity.value.slice(1);
            var distance = document.getElementById("activity-distance");
            var timeSpent = document.getElementById("activity-time-spent");
            var comments = document.getElementById("activity-comments");
            
            var activityData = [date.value, timeFormat + "pm", activityUppercase, distance.value + " miles", "512 calories"];
            var tableRef = document.getElementById("workout-table");
            var newRow = tableRef.insertRow(tableRef.rows.length);

            //Do not insert if values are null
            if(date.value == "" || time.value == "" || activity.value == "" || distance.value == "" || timeSpent.value == ""){
              return;
            }

            //Do not insert if Time Spent and Distance are not Integers
            if(isInt(distance.value) == false || isInt(timeSpent.value) == false){
              return;
            }

            var newCell = "";       
            var i = 0;         
            // Use insertCell(index) method to insert new cells (<td> elements) at the 1st, 2nd, 3rd position of the new <tr> element        	      
            while (i < 5)
            {
              newCell = newRow.insertCell(i);            
              newCell.innerHTML = activityData[i];    
              newCell.onmouseover = this.rowIndex; 
              i++;
            }

            //Clear input fields after submission
            document.getElementById("activity-date").value = "";
            document.getElementById("activity-time").value = "";
            document.getElementById("activity").value = "";
            document.getElementById("activity-time-spent").value = "";
            document.getElementById("activity-distance").value = "";
            document.getElementById("activity-comments").value = "";
          }


          //Functions to show/hide table on button press
          //Code with help from: https://www.roseindia.net/javascript/javascriptexamples/javascript-show-hide-table.shtml
          function showTable(){
            document.getElementById('workout-table').style.visibility = "visible";
          }
          function hideTable(){
            document.getElementById('workout-table').style.visibility = "hidden";
          }

          //Event Listeners to trigger functions
          document.getElementById("input-button").addEventListener("click", validateInputTypes);
          document.getElementById("input-button").addEventListener("click", logActivity);
          document.getElementById("show-button").addEventListener("click", showTable);
          document.getElementById("hide-button").addEventListener("click", hideTable);



          //Code for welcome message using arrow function
          document.addEventListener("load", alert("Welcome back Akbar!"))
        


        </script>  


</body>